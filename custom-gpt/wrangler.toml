#:schema node_modules/wrangler/config-schema.json
name = "customgpt"

main = "./server.ts"
compatibility_date = "2024-09-26"
compatibility_flags = ["nodejs_compat"]

[assets]
directory = "./build/client"

[build]
command = "npm run build"

# Production environment variables - non-sensitive only
[vars]
NODE_ENV = "production"
APP_URL = "https://customgpt.your-subdomain.workers.dev"
CLOUDFLARE_ACCOUNT_ID = "7a1ee5c85f806b8611bceb0195d44a6c"
R2_BUCKET_NAME = "ai-agents"
R2_PUBLIC_DOMAIN = "https://pub-3d035218db92408db790b6ce46af0d9e.r2.dev"

# R2 bucket bindings for file storage
[[r2_buckets]]
binding = "FILES_BUCKET"
bucket_name = "ai-agents"
preview_bucket_name = "ai-agents-dev"

[[r2_buckets]]
binding = "MY_BUCKET"
bucket_name = "ai-agents"
preview_bucket_name = "ai-agents-dev"

# AI service binding for Cloudflare AI
[[services]]
binding = "AI"
service = "@cf/meta/llama-2-7b-chat-int8"

# Resource limits for production
[limits]
cpu_ms = 30000