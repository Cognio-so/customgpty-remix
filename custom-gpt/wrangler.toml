#:schema node_modules/wrangler/config-schema.json
name = "mygpt"

main = "./server.ts"
compatibility_date = "2024-09-26"
compatibility_flags = ["nodejs_compat"]

[assets]
directory = "./build/client"

[build]
command = "npm run build"

# Development environment variables - non-sensitive only
[vars]
NODE_ENV = "development"
APP_URL = "http://localhost:5173"

# R2 bucket binding - FIXED
[[r2_buckets]]
binding = "FILES_BUCKET"
bucket_name = "ai-agents"
preview_bucket_name = "ai-agents-dev"

# Alternative binding name to match the code
[[r2_buckets]]
binding = "MY_BUCKET"
bucket_name = "ai-agents"
preview_bucket_name = "ai-agents-dev"

# Service binding
[[services]]
binding = "AI"
service = "@cf/meta/llama-2-7b-chat-int8"

# Production environment variables
[env.production.vars]
CLOUDFLARE_ACCOUNT_ID = "7a1ee5c85f806b8611bceb0195d44a6c"
R2_BUCKET_NAME = "ai-agents"
R2_PUBLIC_DOMAIN = "https://pub-3d035218db92408db790b6ce46af0d9e.r2.dev"
FILES_BUCKET = "ai-agents"